# Regression-Tree-Guided Probabilistic Hull Generation

æœ¬é¡¹ç›®å®žçŽ°äº†åŸºäºŽå›žå½’æ ‘å¼•å¯¼çš„æ¦‚çŽ‡å¤–å£³ç”Ÿæˆæ–¹æ³•ï¼Œç”¨äºŽç¥žç»ç½‘ç»œæ¦‚çŽ‡éªŒè¯ã€‚

## ðŸ“‹ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [çŽ¯å¢ƒé…ç½®](#çŽ¯å¢ƒé…ç½®)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [é¡¹ç›®ç»“æž„](#é¡¹ç›®ç»“æž„)
- [æ ¸å¿ƒç®—æ³•](#æ ¸å¿ƒç®—æ³•)
- [å®žéªŒç»“æžœ](#å®žéªŒç»“æžœ)

## ðŸŽ¯ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æå‡ºäº†ä¸€ç§å›žå½’æ ‘å¼•å¯¼çš„æ¦‚çŽ‡å¤–å£³ç”Ÿæˆæ–¹æ³•ï¼Œç”¨äºŽç¥žç»ç½‘ç»œçš„æ¦‚çŽ‡éªŒè¯ã€‚ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š

- **æ™ºèƒ½é‡‡æ ·ç­–ç•¥**ï¼šè¾¹ç•Œæ„ŸçŸ¥é‡‡æ ·å’Œåˆ†å¸ƒå¼•å¯¼é‡‡æ ·
- **å›žå½’æ ‘å¼•å¯¼åˆ†åŒº**ï¼šè‡ªé€‚åº”åŒºåŸŸåˆ’åˆ†ï¼ŒåŸºäºŽæ¦‚çŽ‡è´¨é‡å¼•å¯¼çš„åˆ†åŒºç­–ç•¥
- **æ¦‚çŽ‡éªŒè¯**ï¼šåŸºäºŽ CROWN è¾¹ç•Œè®¡ç®—çš„å®‰å…¨æ¦‚çŽ‡ä¼°è®¡

## ðŸ”§ çŽ¯å¢ƒé…ç½®

### ç³»ç»Ÿè¦æ±‚

- Python 3.8+ (auto_LiRPA è¦æ±‚ Python 3.7+)
- PyTorch >=1.11.0, <2.3.0 (auto_LiRPA çš„ä¸¥æ ¼ç‰ˆæœ¬è¦æ±‚)
- CUDA 11.1+ (å¯é€‰ï¼Œç”¨äºŽ GPU åŠ é€Ÿ)

### å®‰è£…æ–¹æ³•

#### æ–¹æ³• 1: ä½¿ç”¨ Conda (æŽ¨è)

```bash
# åˆ›å»º conda çŽ¯å¢ƒ
conda env create -f environment.yml

# æ¿€æ´»çŽ¯å¢ƒ
conda activate prob-verification

# å®‰è£… auto_LiRPA (ä½œä¸ºå­æ¨¡å—)
cd auto_LiRPA
pip install -e .

# å¯é€‰ï¼šæž„å»º CUDA æ¨¡å—ä»¥åŠ é€Ÿè®¡ç®—
python auto_LiRPA/cuda_utils.py install
```

#### æ–¹æ³• 2: ä½¿ç”¨ pip

```bash
# åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ– venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å®‰è£… auto_LiRPA (ä½œä¸ºå­æ¨¡å—)
cd auto_LiRPA
pip install -e .

# å¯é€‰ï¼šæž„å»º CUDA æ¨¡å—
python auto_LiRPA/cuda_utils.py install
```

**é‡è¦æç¤º**ï¼šauto_LiRPA éœ€è¦ä½œä¸ºå­æ¨¡å—åŒ…å«åœ¨é¡¹ç›®ä¸­ã€‚å¦‚æžœä½¿ç”¨ Git å…‹éš†ï¼Œè¯·è¿è¡Œï¼š
```bash
git submodule update --init --recursive
```

## ðŸš€ å¿«é€Ÿå¼€å§‹

### è¿è¡Œå®žéªŒ

1. **ACAS Xu å®žéªŒ (ReLU ç½‘ç»œ)**:
   ```bash
   cd src
   python acas.py
   ```

2. **ACAS Xu å®žéªŒ (Tanh ç½‘ç»œ)**:
   ```bash
   cd src
   python acas_tanh.py
   ```

3. **RocketNet å®žéªŒ**:
   ```bash
   cd src
   python rocketnet.py
   ```

### å®žéªŒç»“æžœ

æ‰€æœ‰å®žéªŒç»“æžœå°†ä¿å­˜åœ¨ `results/` ç›®å½•ä¸­ï¼š
- `results/acas_experiments/` - ACAS å®žéªŒç»“æžœ
- `results/tanh_experiments/` - Tanh ç½‘ç»œå®žéªŒç»“æžœ
- `results/rocketnet_experiments/` - RocketNet å®žéªŒç»“æžœ

## ðŸ“ é¡¹ç›®ç»“æž„

```
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ acas.py                  # ACAS Xu ReLU ç½‘ç»œå®žéªŒä¸»ç¨‹åº
â”‚   â”œâ”€â”€ acas_tanh.py             # ACAS Xu Tanh ç½‘ç»œå®žéªŒä¸»ç¨‹åº
â”‚   â”œâ”€â”€ rocketnet.py             # RocketNet å®žéªŒä¸»ç¨‹åº
â”‚   â”œâ”€â”€ construct_acas_tanh.py   # ACAS Tanh ç½‘ç»œæž„å»ºå·¥å…·
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ load.py              # æ¨¡åž‹åŠ è½½å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ utils.py             # æ ¸å¿ƒè®¡ç®—å·¥å…·
â”‚   â”‚   â””â”€â”€ __init__.py
â”‚   â”‚
â”‚   â”œâ”€â”€ samplers/                # é‡‡æ ·å™¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ uniform_boundary_sampler.py      # å‡åŒ€è¾¹ç•Œé‡‡æ ·
â”‚   â”‚   â”œâ”€â”€ distribution_boundary_sampler.py # åˆ†å¸ƒè¾¹ç•Œé‡‡æ ·
â”‚   â”‚   â””â”€â”€ __init__.py
â”‚   â”‚
â”‚   â”œâ”€â”€ regression_tree/         # å›žå½’æ ‘æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ tree_builder.py      # å†³ç­–æ ‘æž„å»ºå™¨
â”‚   â”‚   â””â”€â”€ __init__.py
â”‚   â”‚
â”‚   â””â”€â”€ models/                  # ç½‘ç»œæ¨¡åž‹
â”‚       â”œâ”€â”€ tiny_network.py     # 2D ç¤ºä¾‹ç½‘ç»œ
â”‚       â”œâ”€â”€ deep_network_2d.py  # æ·±åº¦ 2D ç½‘ç»œ
â”‚       â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ checkpoints/                 # é¢„è®­ç»ƒæ¨¡åž‹ (è§ checkpoints/README.md)
â”‚   â”œâ”€â”€ acas/                   # ACAS ReLU æ¨¡åž‹
â”‚   â”œâ”€â”€ acas_tanh/              # ACAS Tanh æ¨¡åž‹
â”‚   â””â”€â”€ RocketNetReLU/          # RocketNet æ¨¡åž‹
â”‚
â”œâ”€â”€ docs/                        # æ–‡æ¡£
â”‚   â””â”€â”€ artifacts.md            # èµ„æºèŽ·å–è¯´æ˜Ž
â”‚
â”œâ”€â”€ requirements.txt             # Python ä¾èµ–
â”œâ”€â”€ environment.yml              # Conda çŽ¯å¢ƒé…ç½®
â””â”€â”€ README.md                    # æœ¬æ–‡ä»¶
```

## ðŸ”¬ æ ¸å¿ƒç®—æ³•

æœ¬é¡¹ç›®å®žçŽ°äº†ä»¥ä¸‹å…³é”®ç®—æ³•ï¼š

1. **æ™ºèƒ½é‡‡æ ·ç­–ç•¥**ï¼š
   - è¾¹ç•Œæ„ŸçŸ¥é‡‡æ ·
   - åˆ†å¸ƒå¼•å¯¼é‡‡æ ·
   - æ··åˆé‡‡æ ·ç­–ç•¥

2. **å›žå½’æ ‘å¼•å¯¼åˆ†åŒº**ï¼š
   - è‡ªé€‚åº”åŒºåŸŸåˆ’åˆ†
   - æ¦‚çŽ‡è´¨é‡å¼•å¯¼çš„åˆ†åŒºç­–ç•¥
   - å¹¶è¡ŒåŒ–æ ‘æž„å»º

3. **æ¦‚çŽ‡éªŒè¯**ï¼š
   - CROWN è¾¹ç•Œè®¡ç®—
   - å®‰å…¨æ¦‚çŽ‡ä¼°è®¡
   - æ”¶æ•›æ£€æŸ¥

## ðŸ“Š å®žéªŒç»“æžœ

æ¯ä¸ªå®žéªŒè¾“å‡ºä»¥ä¸‹å…³é”®æŒ‡æ ‡ï¼š

- **Ls**: ä¸‹ç•Œå®‰å…¨æ¦‚çŽ‡
- **Us**: ä¸Šç•Œå®‰å…¨æ¦‚çŽ‡
- **Us-Ls**: æ¦‚çŽ‡åŒºé—´å®½åº¦
- **time**: è¿è¡Œæ—¶é—´ (ç§’)

è¾ƒå°çš„ `Us-Ls` å€¼è¡¨ç¤ºæ›´ç²¾ç¡®çš„æ¦‚çŽ‡ä¼°è®¡ã€‚

### å®žéªŒå‚æ•°

å…³é”®å®žéªŒå‚æ•°ï¼ˆåœ¨è„šæœ¬ä¸­å›ºå®šï¼‰ï¼š
- **æ€»é‡‡æ ·æ•°**: 1000 (ACAS), 9000 (RocketNet)
- **å¢žé‡é‡‡æ ·æ•°**: 100 (ACAS), 900 (RocketNet)
- **æœ€å¤§æ ‘æ·±åº¦**: 5
- **æœªçŸ¥æ¦‚çŽ‡é˜ˆå€¼**: 1e-5 (ACAS), 1e-3 (RocketNet)
- **ç³»æ•°å‚æ•°**: 0.3

## ðŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) è®¸å¯è¯ã€‚è¯¦æƒ…è¯·å‚é˜… LICENSE æ–‡ä»¶ã€‚

## ðŸ”— ç›¸å…³èµ„æº

- **æ¨¡åž‹æƒé‡**: è¯·å‚é˜… [checkpoints/README.md](checkpoints/README.md) äº†è§£å¦‚ä½•èŽ·å–é¢„è®­ç»ƒæ¨¡åž‹
- **å®žéªŒèµ„æº**: è¯·å‚é˜… [docs/artifacts.md](docs/artifacts.md) äº†è§£é¢å¤–çš„å®žéªŒæ•°æ®å’Œèµ„æº

